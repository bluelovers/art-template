{"version":3,"sources":["../../src/compile/defaults.js"],"names":["runtime","require","extend","include","onerror","caches","loader","artRule","nativeRule","htmlMinifier","resolveFilename","detectNode","window","settings","source","filename","rules","escape","debug","process","env","NODE_ENV","bail","cache","minimize","compileDebug","htmlMinifierOptions","collapseWhitespace","minifyCSS","minifyJS","ignoreCustomFragments","root","extname","ignore","imports","reverse","push","use","_split","test","Defaults","$extend","options","prototype","module","exports"],"mappings":";;AAAA,IAAMA,UAAUC,QAAQ,WAAR,CAAhB;AACA,IAAMC,SAASD,QAAQ,kBAAR,CAAf;AACA,IAAME,UAAUF,QAAQ,mBAAR,CAAhB;AACA,IAAMG,UAAUH,QAAQ,mBAAR,CAAhB;AACA,IAAMI,SAASJ,QAAQ,kBAAR,CAAf;AACA,IAAMK,SAASL,QAAQ,kBAAR,CAAf;AACA,IAAMM,UAAUN,QAAQ,oBAAR,CAAhB;AACA,IAAMO,aAAaP,QAAQ,uBAAR,CAAnB;AACA,IAAMQ,eAAeR,QAAQ,yBAAR,CAArB;AACA,IAAMS,kBAAkBT,QAAQ,4BAAR,CAAxB;;AAEA,IAAMU,aAAa,OAAOC,MAAP,KAAkB,WAArC;;AAEA;AACA,IAAMC,WAAW;AACb;AACAC,YAAQ,IAFK;;AAIb;AACAC,cAAU,IALG;;AAOb;AACAC,WAAO,CAACR,UAAD,EAAaD,OAAb,CARM;;AAUb;AACA;AACAU,YAAQ,IAZK;;AAcb;AACAC,WAAOP,aAAaQ,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,YAAtC,GAAqD,KAf/C;;AAiBb;AACAC,UAAM,IAlBO;;AAoBb;AACAC,WAAO,IArBM;;AAuBb;AACA;AACAC,cAAU,IAzBG;;AA2Bb;AACAC,kBAAc,KA5BD;;AA8Bb;AACAf,qBAAiBA,eA/BJ;;AAiCb;AACAP,aAASA,OAlCI;;AAoCb;AACAM,kBAAcA,YArCD;;AAuCb;AACAiB,yBAAqB;AACjBC,4BAAoB,IADH;AAEjBC,mBAAW,IAFM;AAGjBC,kBAAU,IAHO;AAIjB;AACAC,+BAAuB;AALN,KAxCR;;AAgDb;AACA1B,aAASA,OAjDI;;AAmDb;AACAE,YAAQA,MApDK;;AAsDb;AACAD,YAAQA,MAvDK;;AAyDb;AACA0B,UAAM,GA1DO;;AA4Db;AACAC,aAAS,MA7DI;;AA+Db;AACAC,YAAQ,EAhEK;;AAkEb;AACAC,aAASlC;AAnEI,CAAjB;;AAsEAa,SAASG,KAAT,CAAemB,OAAf;;AAEAtB,SAASG,KAAT,CAAeoB,IAAf,CAAoB;AAChBC,SAAK9B,QAAQ8B,GADG;AAEhBC,YAAQ/B,QAAQ+B,MAFA;;AAIhBC,UAAM;AAJU,CAApB;;AAOA1B,SAASG,KAAT,CAAeoB,IAAf,CAAoB;AAChBC,SAAK9B,QAAQ8B,GADG;AAEhBC,YAAQ/B,QAAQ+B,MAFA;;AAIhBC,UAAM;AAJU,CAApB;;AAOA1B,SAASG,KAAT,CAAeoB,IAAf,CAAoB;AAChBC,SAAK7B,WAAW6B,GADA;AAEhBC,YAAQ9B,WAAW8B,MAFH;;AAIhBC,UAAM;AAJU,CAApB;;AAOA1B,SAASG,KAAT,CAAemB,OAAf;;AAEA,SAASK,QAAT,GAAoB;AAChB,SAAKC,OAAL,GAAe,UAASC,OAAT,EAAkB;AAC7BA,kBAAUA,WAAW,EAArB;AACA,eAAOxC,OAAOwC,OAAP,EAAgBA,mBAAmBF,QAAnB,GAA8BE,OAA9B,GAAwC,IAAxD,CAAP;AACH,KAHD;AAIH;AACDF,SAASG,SAAT,GAAqB9B,QAArB;;AAEA+B,OAAOC,OAAP,GAAiB,IAAIL,QAAJ,EAAjB","file":"defaults.js","sourcesContent":["const runtime = require('./runtime');\nconst extend = require('./adapter/extend');\nconst include = require('./adapter/include');\nconst onerror = require('./adapter/onerror');\nconst caches = require('./adapter/caches');\nconst loader = require('./adapter/loader');\nconst artRule = require('./adapter/rule.art');\nconst nativeRule = require('./adapter/rule.native');\nconst htmlMinifier = require('./adapter/html-minifier');\nconst resolveFilename = require('./adapter/resolve-filename');\n\nconst detectNode = typeof window === 'undefined';\n\n/** 模板编译器默认配置 */\nconst settings = {\n    // 模板内容。如果没有此字段，则会根据 filename 来加载模板内容\n    source: null,\n\n    // 模板名\n    filename: null,\n\n    // 模板语法规则列表\n    rules: [nativeRule, artRule],\n\n    // 是否开启对模板输出语句自动编码功能。为 false 则关闭编码输出功能\n    // escape 可以防范 XSS 攻击\n    escape: true,\n\n    // 启动模板引擎调试模式。如果为 true: {cache:false, minimize:false, compileDebug:true}\n    debug: detectNode ? process.env.NODE_ENV !== 'production' : false,\n\n    // bail 如果为 true，编译错误与运行时错误都会抛出异常\n    bail: true,\n\n    // 是否开启缓存\n    cache: true,\n\n    // 是否开启压缩。它会运行 htmlMinifier，将页面 HTML、CSS、CSS 进行压缩输出\n    // 如果模板包含没有闭合的 HTML 标签，请不要打开 minimize，否则可能被 htmlMinifier 修复或过滤\n    minimize: true,\n\n    // 是否编译调试版\n    compileDebug: false,\n\n    // 模板路径转换器\n    resolveFilename: resolveFilename,\n\n    // 子模板编译适配器\n    include: include,\n\n    // HTML 压缩器。仅在 NodeJS 环境下有效\n    htmlMinifier: htmlMinifier,\n\n    // HTML 压缩器配置。参见 https://github.com/kangax/html-minifier\n    htmlMinifierOptions: {\n        collapseWhitespace: true,\n        minifyCSS: true,\n        minifyJS: true,\n        // 运行时自动合并：rules.map(rule => rule.test)\n        ignoreCustomFragments: []\n    },\n\n    // 错误事件。仅在 bail 为 false 时生效\n    onerror: onerror,\n\n    // 模板文件加载器\n    loader: loader,\n\n    // 缓存中心适配器（依赖 filename 字段）\n    caches: caches,\n\n    // 模板根目录。如果 filename 字段不是本地路径，则在 root 查找模板\n    root: '/',\n\n    // 默认后缀名。如果没有后缀名，则会自动添加 extname\n    extname: '.art',\n\n    // 忽略的变量。被模板编译器忽略的模板变量列表\n    ignore: [],\n\n    // 导入的模板变量\n    imports: runtime\n};\n\nsettings.rules.reverse();\n\nsettings.rules.push({\n    use: artRule.use,\n    _split: artRule._split,\n    \n    test: /{{([@#]?)[ \\t]*()([\\w\\W]*?)[ \\t]*}}(?:\\r\\n|\\n|\\r)?/,\n});\n\nsettings.rules.push({\n    use: artRule.use,\n    _split: artRule._split,\n    \n    test: /(?:(?:\\r\\n|\\n|\\r)[ \\t]*)?{{([@#]?)[ \\t]*(\\/)([\\w\\W]*?)[ \\t]*}}/,\n});\n\nsettings.rules.push({\n    use: nativeRule.use,\n    _split: nativeRule._split,\n\n    test: /(?:(?:\\r\\n|\\n|\\r)[ \\t]*)?<%(#?)((?:==|=#|[=-])?)[ \\t]*(\\})[ \\t]*(-?)%>(?:(?:\\r\\n|\\n|\\r)(?=[ \\t]*(?:<%|{{)))?/,\n});\n\nsettings.rules.reverse();\n\nfunction Defaults() {\n    this.$extend = function(options) {\n        options = options || {};\n        return extend(options, options instanceof Defaults ? options : this);\n    };\n}\nDefaults.prototype = settings;\n\nmodule.exports = new Defaults();\n"]}